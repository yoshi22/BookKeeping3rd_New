# 問題生成システム全面見直し - 分析フェーズ

**実施日**: 2025年8月6日  
**目的**: problemsStrategy.mdの要件を完全に満たす問題生成システムの構築

## 📋 現状分析

### 1. 既存データファイルの状況

#### 発見されたファイル

- `src/data/extracted-questions.ts`: 604問（おそらく仕訳問題）
- `src/data/generated-questions.ts`: 24問（追加問題）
- `src/data/all-questions-integrated.ts`: 統合試行の形跡
- `src/data/sample-questions-new.ts`: 新システム用エクスポート

#### 問題点

1. データベースに接続できない（開発環境の問題か）
2. 複数のデータファイルが並存し、真の情報源が不明確
3. カテゴリー・難易度の設定方法が不統一

### 2. problemsStrategy.mdの要件

#### 試験構成（目標）

| 問題  | 配点  | 問題数 | 詳細                             |
| ----- | ----- | ------ | -------------------------------- |
| 第1問 | 45点  | 15問   | 仕訳問題（各3点）                |
| 第2問 | 20点  | 2問    | 補助簿・勘定記入・伝票（各10点） |
| 第3問 | 35点  | 1問    | 決算書作成                       |
| 合計  | 100点 | 18問   | 1回の試験セット                  |

#### 練習問題プール（目標）

- **仕訳問題**: 250問（6カテゴリー×約40問）
- **帳簿問題**: 40問
- **試算表問題**: 12問
- **合計**: 302問

#### 仕訳カテゴリー詳細（250問）

1. **現金・預金取引**: 42問
2. **商品売買取引**: 45問
3. **債権・債務**: 41問
4. **給与・税金**: 42問
5. **固定資産**: 40問
6. **決算整理**: 40問

#### 難易度設定（3段階）

- **難易度1（基礎）**: 基本的な仕訳・単純な取引
- **難易度2（標準）**: 複数勘定・通常の業務処理
- **難易度3（応用）**: 決算整理・複雑な取引

### 3. 過去の試行錯誤から学ぶべき点

#### 失敗の可能性

1. **データ統合の複雑さ**: 複数ソースからの統合が混乱を招いた
2. **カテゴリー判定の曖昧さ**: 自動判定ロジックが不正確
3. **難易度設定の不整合**: 基準が明確でない
4. **型定義の不一致**: TypeScriptの型とデータの不整合

#### 成功していた点

- problemsStrategy.mdという明確な仕様書の存在
- カテゴリー別の目標問題数の明確化

## 🎯 新アプローチの方針

### 基本方針

1. **Single Source of Truth**: 1つの明確なデータソース
2. **明示的な分類**: 自動判定ではなく明示的な分類
3. **段階的な構築**: 小さく始めて確実に検証
4. **型安全性の確保**: TypeScriptの恩恵を最大限活用

### 実装ステップ（案）

1. 型定義とインターフェースの明確化
2. マスターデータの構築（JSON形式）
3. 検証システムの構築
4. データベースへの投入
5. 学習画面での動作確認

## 📊 現在のデータ分析結果

（次のステップで詳細分析予定）

---

**次のアクション**: 既存データファイルの詳細分析と型定義の確認
